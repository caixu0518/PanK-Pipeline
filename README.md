# PanK-Pipeline: A Pan-genome _K_-mer Pipeline for Population Analysis

## Introduction

## Installation
The pipeline [PanK-Pipeline](https://github.com/caixu0518/PanK-Pipeline) is installation-free but requires dependencies: 

Required:
1. [jellyfish](https://github.com/gmarcais/Jellyfish). In the present pipeline, jellyfish is mainly used to quickly generate _k_-mers from resequencing reads and perform _k_-mer query.
2. [bedtools](https://github.com/arq5x/bedtools2)(v2.27.1).

Optional：
1. [plink](https://www.cog-genomics.org/plink2/) (v1.90b6.21). plink is mainly used when performing population structure and PCA analysis with _k_-mers.
2. [VCF2Dis](https://doi.org/10.1093/gigascience/giaf032)(VCF2Dis-1.54). VCF2Dis] is used to make the phylogenetic tree based on _k_-mer presence and absence matrix.
3. [faststructure](https://github.com/rajanil/fastStructure). faststructure is used to make the population structure analysis. The present pipeline recomeneded a docker repository (dockerbiotools/faststructure).   

## Inputs

## Outputs


## PanK-Pipeline
Here, We applied the _Brassica rapa_ pangenome, comprising 30 assemblies, together with resequencing data from 1,543 accessions, to demonstrate the [PanK-Pipeline](https://github.com/caixu0518/PanK-Pipeline) pipeline. This pipeline is broadly applicable to pangenome assemblies and population resequencing data from any species.

### Step1. Pipeline for constructing polymorphic _k_-mers using 30 _B. rapa_ genome assemblies.
The current script Generate_PolymorphyicKmers.pl is used for constructing polymorphic _k_-mers using Pan-genome assemblies
```
perl  Generate_PolymorphyicKmers.pl  -species Brapa  -ksize 17  -pangenome  Pangenome.txt  -PipelinePath  /mydata/caix/PanK-Pipeline

-species        [required]    Prefix for output files    i.e. Brapa
-ksize          [required]    k-mer size  i.e 17
-pangenome      [required]    A file containing the abbreviation of each pan-genome member together with the absolute path to its genome sequence.
-PipelinePath   [required]    The absolute path to the PanK-Pipeline directory   i.e. /mydata/caix/PanK-Pipeline

##- A detailed example of the '-pangenome' parameter input file: the first column specifies the abbreviation, and the second column specifies the absolute path to the genome FASTA file, with columns separated by a tab.
Bra_A03.A04	/mydata/caix/PanK-Pipeline/data/aa/new/Bra_A03.A04.fasta
Bra_BRO.A04	/mydata/caix/PanK-Pipeline/data/aa/new/Bra_BRO.A04.fasta
Bra_CCA.A04	/mydata/caix/PanK-Pipeline/data/aa/new/Bra_CCA.A04.fasta

##- The output file of Step 1 have the suffix “.list.Polymorphic_kmers.List” and serve as the input files for Step 2. The file contains three columns: the first column is the k-mer sequence; the second column indicates the total number of occurrences of the k-mer across the pangenome; and the third column reports the frequency of the k-mer among the pangenome members, calculated as the proportion of genomes containing the k-mer relative to the total number of genomes.
see an example:
ATTGCATTCCTTAAAAC  100  0.33
CTGACCTCCTTTGTCTC  190  0.43
GGGCATCCACGACTTTA  80  0.20
```

### Step2: Pipeline for identifying representative _k_-mers across the _B. rapa_ species.
```
perl  Generate_RepresentativeKmers.pl  -species  Brapa  -ksize  17  -pangenome  Pangenome.txt    -PipelinePath   /mydata/caix/PanK-Pipeline   -PolymorphicKmer  rapa.merged.kmer.k17.list.Polymorphic_kmers.List
-species            [required]    Prefix for output files    i.e. Brapa
-ksize              [required]    k-mer size  i.e 17
-pangenome          [required]    A file containing the abbreviation of each pan-genome member together with the absolute path to its genome sequence.
-PipelinePath       [required]    The absolute path to the PanK-Pipeline directory   i.e. /mydata/caix/PanK-Pipeline
-PolymorphicKmer    [required]    rapa.merged.kmer.k17.list.Polymorphic_kmers.List

##- 'rapa.merged.kmer.k17.list.Polymorphic_kmers.List' was generated by the step 1.
##- The output files of Step 2 have the suffix “.representative.list” and share the same format as the “.list.Polymorphic_kmers.List” files generated in Step 1.
```
### Step3：Application of species-representative _k_-mers for population structure analysis in _B. rapa_.
```

```


## Citations


